# i18n Guide

## Add a New Language

1. Create a new messages file in `messages/<locale>.json`.
1. Add the locale to `src/i18n.ts` in the `locales` array and update `defaultLocale` if needed.
1. Ensure `NEXT_PUBLIC_SITE_URL` is set in your environment so metadata alternates and canonical URLs are absolute in production.
1. Translate all keys, including `cv` data and `metadata`.

## Add or Update Translation Keys

1. Add the new key to both `messages/es.json` and `messages/en.json`.
1. Consume the key with `getTranslations` (server components) or `useTranslations` (client components).
1. Avoid hardcoded strings in JSX. Prefer semantic keys like `sections.projects.title`.

## How Locale Detection Works

- `middleware.ts` enforces locale-prefixed routes (`/es`, `/en`) and sets the `NEXT_LOCALE` cookie.
- `src/i18n.ts` loads messages per locale and defines available locales.
- `src/app/[locale]/layout.tsx` provides `NextIntlClientProvider` and renders the localized skip link.
- `src/app/layout.tsx` reads the active locale with `getLocale()` to set `<html lang="...">`.

## Locale Persistence

- `LanguageSwitcher` updates the URL without a full reload and sets `NEXT_LOCALE` for future visits.
- The middleware also keeps the locale cookie in sync based on the current URL.
